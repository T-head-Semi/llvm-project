# RUN: llc %s -mtriple=riscv64 -mcpu=c906 -verify-misched -run-pass=machine-scheduler -o - | FileCheck %s -check-prefix=C906
# RUN: llc %s -mtriple=riscv64 -mcpu=c910 -verify-misched -run-pass=machine-scheduler -o - | FileCheck %s -check-prefix=C910

--- |
 define i64 @mula(i64 %A, i64 %B, i64 %C) #0 {
    %tmp1 = add i64 %A, %B
    %tmp2 = add i64 %A, %tmp1
    %tmp3 = add i64 %A, %tmp2
    %tmp4 = add i64 %A, %tmp3
    %tmp5 = add i64 %A, %tmp4
    %tmp6 = add i64 %A, %tmp5
    %tmp7 = add i64 %A, %tmp6
    %tmp8 = add i64 %A, %tmp7
    %tmp9 = mul i64 %A, %B
    %tmp10 = add i64 %tmp9, %C
    %tmp11 = mul i64 %tmp10, %B
    %tmp12 = add i64 %tmp11, %C
    %tmp13 = add i64 %tmp8, %tmp12
    ret i64 %tmp13
  }

...
---
name:            mula
alignment:       2
tracksRegLiveness: true
body:             |
  bb.0 (%ir-block.0):
    liveins: $x10, $x11, $x12

    ; C906-LABEL: name: mula
    ; C906: liveins: $x10, $x11, $x12
    ; C906: ADD
    ; C906-NEXT: ADD
    ; C906-NEXT: ADD
    ; C906-NEXT: ADD
    ; C906-NEXT: COPY
    ; C906-NEXT: MULA
    ; C906-NEXT: ADD
    ; C906-NEXT: ADD
    ; C906-NEXT: MULA
    ; C906-NEXT: ADD
    ; C906-NEXT: ADD
    ; C906-NEXT: ADD

    ; C910-LABEL: name: mula
    ; C910: liveins: $x10, $x11
    ; C910: ADD
    ; C910-NEXT: MULA
    ; C910-NEXT: ADD
    ; C910-NEXT: ADD
    ; C910-NEXT: ADD
    ; C910-NEXT: ADD
    ; C910-NEXT: MULA
    ; C910-NEXT: ADD
    ; C910-NEXT: ADD
    ; C910-NEXT: ADD
    ; C910-NEXT: ADD

    %12:gpr = COPY $x12
    %1:gpr = COPY $x11
    %0:gpr = COPY $x10
    %3:gpr = ADD %0, %1
    %4:gpr = ADD %0, %3
    %5:gpr = ADD %0, %4
    %6:gpr = ADD %0, %5
    %7:gpr = ADD %0, %6
    %8:gpr = ADD %0, %7
    %9:gpr = ADD %0, %8
    %10:gpr = ADD %0, %9
    %11:gpr = COPY %12
    %11:gpr = MULA %11, %0, %1
    %12:gpr = MULA %12, %11, %1
    %13:gpr = ADD %10, %12
    $x10 = COPY %13
    PseudoRET implicit $x10

...
